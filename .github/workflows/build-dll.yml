name: Build DXGI Screen Capture DLL

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-windows:
    runs-on: windows-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup MSBuild
        uses: microsoft/setup-msbuild@v2
        with:
          msbuild-architecture: x64

      # 【终极调试】打印所有文件的完整路径（必看！）
      - name: Print ALL file paths (find vcxproj)
        run: |
          Write-Host "=== Full path of all files ==="
          Get-ChildItem -Path . -Recurse -Name | ForEach-Object {
              $fullPath = Join-Path -Path (Get-Location) -ChildPath $_
              Write-Host "File: $fullPath"
          }
        shell: powershell

      # 先暂停编译（先看调试日志）
      - name: Temporary pause (check log first)
        run: Write-Host "Check the log above to find MirrorScreen.vcxproj path!"
        shell: powershell
